{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Searching and Downloading Genome Data using NCBI Datasets","text":"<p>This session is part of Biodiversity Genomics Academy 2023</p> <p>Thu 14 Sep, 17:00 UTC Join on Zoom</p> <p>This session will use Gitpod so you will get the most out of it if you already have a Gitpod account and know how to launch a Gitpod workspace (instructions here)</p>"},{"location":"#session-leaders","title":"Session Leader(s)","text":"<p>Nuala O'Leary Mirian T. N. Tsuchiya Eric Cox  </p> <p>National Center for Biotechnology Information</p>"},{"location":"#description","title":"Description","text":"<p>By the end of this session you will be able to:</p> <ol> <li>How to find and download assembled genomes and related data on the web using NCBI Datasets</li> <li>How to find and download assembled genomes and related data using NCBI Datasets command-line tools</li> </ol>"},{"location":"#session-materials","title":"Session Materials","text":"<ul> <li>CLI Tutorial</li> </ul>"},{"location":"#prerequisites","title":"Prerequisites","text":"<ol> <li>Understanding the terms genome assembly, reads, contigs</li> <li>Some familiarity with the linux command-line interface</li> </ol> <p>Please make sure you MEET THE PREREQUISITES and READ THE DESCRIPTION above</p> <p>You will get the most out of this session if you meet the prerequisites above.</p> <p>Please also read the description carefully to see if this session is relevant to you.</p> <p>If you don't meet the prerequisites or change your mind based on the description or are no longer available at the session time, please email tol-training at sanger.ac.uk to cancel your slot so that someone else on the waitlist might attend.</p>"},{"location":"NCBI-datasets-cli/","title":"Searching and Downloading Genome Data using NCBI Datasets","text":""},{"location":"NCBI-datasets-cli/#table-of-contents","title":"Table of contents","text":"<ol> <li>NCBI Datasets: the CLI version     1a. Installing NCBI datasets</li> <li>Genome retrieval options. </li> <li>Using the datasets CLI to download a single genome assembly</li> <li>How can I download multiple genomes at once using datasets?     4a. Using dataformat to explore metadata</li> <li>Datasets documentation and tutorials</li> <li>Bonus exercise: downloading a large number of genomes</li> </ol>"},{"location":"NCBI-datasets-cli/#1-ncbi-datasets-the-cli-version","title":"1. NCBI Datasets: the CLI version","text":"<p>NCBI Datasets comprises an API, a web-interface and a command-line tool (CLI). In this workshop, we already covered the web-interface and how it can be used to search and download for your genomes of interest. </p> <p></p> <p>As useful as the web interface is, at times it's much more convenient to have a way of accessing genomes from a command-line environment. Let's say your working on your institution's high-performance computing (HPC) system and you need to download dozens (or hundreds of genomes). Even if you're using the Datasets web interface, this would potentially be a two step process: </p> <ol> <li>Download the genome data package locally;</li> <li>Transfer the files to the HPC system.</li> </ol> <p>With the NCBI Datasets CLI, you can do this process in a single step. Our CLI allows users to access not only genomes, but also genes, ortholog sets and virus genomes. </p> <p></p>"},{"location":"NCBI-datasets-cli/#1a-installing-ncbi-datasets","title":"1a. Installing NCBI Datasets","text":"<p>For this exercise, we will install the datasets CLI in the GitPod instance you are using. The same instructions can be followed to to install it on your own machine or HPC system.</p> <p>The list of commands below will accomplish the following tasks:  </p> <ol> <li>Create a new conda environment named <code>datasets</code> and install the datasets CLI tool and the UNIX tree tool (useful for visualizing the folder structure) in that new environment.  </li> <li>Activate the <code>datasets</code> environment.  </li> <li>Test the installation by calling the datasets CLI.</li> </ol> <p><pre><code>conda create -n datasets -c conda-forge ncbi-datasets-cli tree -y\nconda activate datasets\ndatasets\n</code></pre> The command <code>datasets</code> will print the help message below:  </p> <pre><code>datasets is a command-line tool that is used to query and download biological sequence data\nacross all domains of life from NCBI databases.\n\nRefer to NCBI's [download and install](https://www.ncbi.nlm.nih.gov/datasets/docs/v2/download-and-install/) documentation for information about getting started with the command-line tools.\n\nUsage\n  datasets [command]\n\nData Retrieval Commands\n  summary     Print a data report containing gene, genome or virus metadata\n  download    Download a gene, genome or virus dataset as a zip file\n  rehydrate   Rehydrate a downloaded, dehydrated dataset\n\nMiscellaneous Commands\n  completion  Generate autocompletion scripts\n\nFlags\n      --api-key string   Specify an NCBI API key\n      --debug            Emit debugging info\n      --help             Print detailed help about a datasets command\n      --version          Print version of datasets\n\nUse datasets &lt;command&gt; --help for detailed help about a command.\n</code></pre>"},{"location":"NCBI-datasets-cli/#2-genome-retrieval-options","title":"2. Genome retrieval options","text":"<p>Today we're focusing on retrieving genome data and metadata using the NCBI Datasets CLI. We will explore the options available to download data and metadata, including filtering options. </p> <p>For this exercise, we will be the using an environment in Gitpod. You need your GitHub credentials to login to it. Here's the link to the NCBI Datasets pod: </p> <p>In this environment, we have the necessary tools installed for you to explore NCBI Datasets without the need to configure anything. When you decide to use NCBI Datasets on your own machine or HPC system, you need to install it. More information on how to install NCBI Datasets can be found in our documentation page.</p> <p>The NCBI Datasets CLI command structure is very intuitive. If you take a look at the diagram below, you will notice that the commands are built by choosing one option from each vertical rectangle. Let's start!</p> <p></p> <p>The datasets CLI has even more filtering options than the web-interface. For example: for chromosome level assemblies, you can choose which chromosomes to download using the <code>--chromosomes</code> flag. Use the <code>--help</code> flag to see all available flags and options in datasets. </p> <p><pre><code>datasets download genome taxon --help\n</code></pre> Result:</p> <pre><code>Flags\n      --assembly-version string   Limit to 'latest' assembly accession version or include 'all' (latest + previous versions)\n                                     (default \"latest\")\n      --include string(,string)   Specify the data files to include (comma-separated).\n                                    * genome:     genomic sequence\n                                    * rna:        transcript\n                                    * protein:    amnio acid sequences\n                                    * cds:        nucleotide coding sequences\n                                    * gff3:       general feature file\n                                    * gtf:        gene transfer format\n                                    * gbff:       GenBank flat file\n                                    * seq-report: sequence report file\n                                    * none:       do not retrieve any sequence files\n                                     (default [genome])\n      --reference                 Limit to reference genomes\n      --tax-exact-match           Exclude sub-species when a species-level taxon is specified\n\nGlobal Flags\n      --annotated                Limit to annotated genomes\n      --api-key string           Specify an NCBI API key\n      --assembly-level string    Limit to genomes at one or more assembly levels (comma-separated):\n                                   * chromosome\n                                   * complete\n                                   * contig\n                                   * scaffold\n                                    (default \"[]\")\n      --assembly-source string   Limit to 'RefSeq' (GCF_) or 'GenBank' (GCA_) genomes (default \"all\")\n      --chromosomes strings      Limit to a specified, comma-delimited list of chromosomes, or 'all' for all chromosomes\n      --debug                    Emit debugging info\n      --dehydrated               Download a dehydrated zip archive including the data report and locations of data files (use the rehydrate command to retrieve data files).\n      --exclude-atypical         Exclude atypical assemblies\n      --filename string          Specify a custom file name for the downloaded data package (default \"ncbi_dataset.zip\")\n      --help                     Print detailed help about a datasets command\n      --mag string               Limit to metagenome assembled genomes (only) or remove them from the results (exclude) (default \"all\")\n      --no-progressbar           Hide progress bar\n      --preview                  Show information about the requested data package\n      --released-after string    Limit to genomes released on or after a specified date (MM/DD/YYYY)\n      --released-before string   Limit to genomes released on or before a specified date (MM/DD/YYYY)\n      --search strings           Limit results to genomes with specified text in the searchable fields:\n                                 species and infraspecies, assembly name and submitter.\n                                 To search multiple strings, use the flag multiple times.\n      --version                  Print version of datasets\n</code></pre>"},{"location":"NCBI-datasets-cli/#3-using-the-datasets-cli-to-download-a-single-genome-assembly","title":"3. Using the datasets CLI to download a single genome assembly","text":"<p>For our first exercise, let's practive downloading a single genome using the datasets CLI. Imagine that you read a genomics paper about an organism that you are interested in (in this case, let's use the California two-spot octopus (Octopus bimaculoides) as our example.  The NCBI assembly accession for this species' reference genome is <code>GCF_001194135.2</code>, and you can use the command below to achieve this goal:</p> <pre><code>datasets download genome accession GCF_001194135.2 --filename octopus-bimaculoides-ref.zip\n\nCollecting 1  records [================================================] 100% 1/1\nDownloading: octopus-bimaculoides-ref.zip    643MB done\n</code></pre> <p>After downloading the data package, let's unzip it and take a look at the folder structure:</p> <pre><code>unzip octopus-bimaculoides-ref.zip -d octopus-ref\n\nArchive:  octopus-bimaculoides-ref.zip\n  inflating: octopus-ref/README.md   \n  inflating: octopus-ref/ncbi_dataset/data/assembly_data_report.jsonl  \n  inflating: octopus-ref/ncbi_dataset/data/GCF_001194135.2/GCF_001194135.2_ASM119413v2_genomic.fna  \n  inflating: octopus-ref/ncbi_dataset/data/dataset_catalog.json  \n</code></pre> <pre><code>tree octopus-ref\n\noctopus-ref/\n|-- README.md\n`-- ncbi_dataset\n    `-- data\n        |-- GCF_001194135.2\n        |   `-- GCF_001194135.2_ASM119413v2_genomic.fna\n        |-- assembly_data_report.jsonl\n        `-- dataset_catalog.json\n\n3 directories, 4 files\n</code></pre> <p>The folder structure of the data package downloaded with the CLI is the same as the one you would get from a web download. The genome assembly FASTA is located inside a folder identified with the assembly accession inside the <code>data</code> folder. The <code>data</code> folder also contains a metadata report (<code>assembly_data_report.jsonl</code>) and a catalog listing which files were included in the data package (<code>dataset_catalog.json</code>).</p> <p>In addition to the genome FASTA file, you might be interested in other files associated with this assembly, such as transcripts, proteins, GFF3, etc. To customize the data package, you can use the flag <code>--include</code> and list everything you would like to download. If the files are available, they will be included in your data package. Let's test that:</p> <p><pre><code>datasets download genome accession GCF_001194135.2 --include genome,rna,protein --filename octopus-genome-rna-prot.zip\n\nCollecting 1  records [================================================] 100% 1/1\nDownloading: octopus-genome-rna-prot.zip    672MB done\n</code></pre> As we can see, this data package is a little bit larger than the one with only the genome FASTA, which is a good sign that the additional files were downloaded. Let's unzip it and see how their inclusion changed the folder structure:</p> <p><pre><code>unzip octopus-genome-rna-prot.zip -d octopus-genome-rna-protein\nArchive:  octopus-genome-rna-prot.zip\n  inflating: octopus-genome-rna-protein/README.md  \n  inflating: octopus-genome-rna-protein/ncbi_dataset/data/assembly_data_report.jsonl  \n  inflating: octopus-genome-rna-protein/ncbi_dataset/data/GCF_001194135.2/GCF_001194135.2_ASM119413v2_genomic.fna  \n  inflating: octopus-genome-rna-protein/ncbi_dataset/data/GCF_001194135.2/rna.fna  \n  inflating: octopus-genome-rna-protein/ncbi_dataset/data/GCF_001194135.2/protein.faa  \n  inflating: octopus-genome-rna-protein/ncbi_dataset/data/dataset_catalog.json  \n</code></pre> <pre><code>tree octopus-genome-rna-protein\n\noctopus-genome-rna-protein\n|-- README.md\n`-- ncbi_dataset\n    `-- data\n        |-- GCF_001194135.2\n        |   |-- GCF_001194135.2_ASM119413v2_genomic.fna\n        |   |-- protein.faa\n        |   `-- rna.fna\n        |-- assembly_data_report.jsonl\n        `-- dataset_catalog.json\n\n3 directories, 6 files\n</code></pre></p> <p>As we can see, this new data package has two extra files in the same folder where the genome FASTA was in the first package we downloaded: <code>rna.fna</code> and <code>protein.faa</code>. </p> <p>Now, let's download multiple genomes at once.</p>"},{"location":"NCBI-datasets-cli/#4-how-can-i-download-multiple-genomes-at-once-using-datasets","title":"4. How can I download multiple genomes at once using datasets?","text":"<p>If we have a long list of genome accessions we want to retrieve, or maybe we want to download all genomes for a certain taxon, datasets CLI allows you to do that in a single command.</p> <p></p> <p>Let's map out a strategy for doing this in the most efficient way possible. By efficient we mean: not downloading unnecessary files, since it costs time and storage to do so.   </p> <p>We can use a web/CLI approach, where we search for the genomes of interest on the web, or we can do everything in the command-line environment. We will explore the command-line only option, and to do so, we will use another CLI tool called dataformat, which is datasets companion tool to explore and convert metadata to TSV or Excel formats.</p>"},{"location":"NCBI-datasets-cli/#4a-using-dataformat-to-explore-metadata","title":"4a. Using dataformat to explore metadata","text":"<p>NCBI Datasets provides metadata reports in JSON or JSON-Lines format, and those can be retrieved in two different ways:  - using <code>datasets summary</code> option; or - as part of any data package.</p> <p>To facilitate the visualization of metadata, you can use dataformat to convert the JSON/JSON-Lines files to TSV or Excel format.</p> <p>In the diagram below, you can see all the different kinds of data reports avaialble and how to build the dataformat command. You can pipe the <code>datasets summary</code> output directly to dataformat using the flag <code>--as-json-lines</code> or you can use the flags <code>--package</code> or <code>--inputfile</code> if you're providing .  Each metadata report has its own list of fields and our schema is recorded in our documentation pages. </p> <p></p> <p>We can also use the <code>--help</code> flag to look at all options and fields. </p> <pre><code>dataformat tsv genome --help\n</code></pre> <p>You can look at the output by clicking in the arrow below:</p> Help output: <pre><code>Flags\n      --fields strings     Comma-separated list of fields\n                               - accession\n                               - ani-best-ani-match-ani\n                               - ani-best-ani-match-assembly\n                               - ani-best-ani-match-assembly_coverage\n                               - ani-best-ani-match-category\n                               - ani-best-ani-match-organism\n                               - ani-best-ani-match-type_assembly_coverage\n                               - ani-best-match-status\n                               - ani-category\n                               - ani-check-status\n                               - ani-comment\n                               - ani-submitted-ani-match-ani\n                               - ani-submitted-ani-match-assembly\n                               - ani-submitted-ani-match-assembly_coverage\n                               - ani-submitted-ani-match-category\n                               - ani-submitted-ani-match-organism\n                               - ani-submitted-ani-match-type_assembly_coverage\n                               - ani-submitted-organism\n                               - ani-submitted-species\n                               - annotinfo-busco-complete\n                               - annotinfo-busco-duplicated\n                               - annotinfo-busco-fragmented\n                               - annotinfo-busco-lineage\n                               - annotinfo-busco-missing\n                               - annotinfo-busco-singlecopy\n                               - annotinfo-busco-totalcount\n                               - annotinfo-busco-ver\n                               - annotinfo-featcount-gene-non-coding\n                               - annotinfo-featcount-gene-other\n                               - annotinfo-featcount-gene-protein-coding\n                               - annotinfo-featcount-gene-pseudogene\n                               - annotinfo-featcount-gene-total\n                               - annotinfo-method\n                               - annotinfo-name\n                               - annotinfo-pipeline\n                               - annotinfo-provider\n                               - annotinfo-release-date\n                               - annotinfo-release-version\n                               - annotinfo-report-url\n                               - annotinfo-software-version\n                               - annotinfo-status\n                               - assminfo-assembly-method\n                               - assminfo-atypicalis-atypical\n                               - assminfo-atypicalwarnings\n                               - assminfo-bioproject\n                               - assminfo-bioproject-lineage-accession\n                               - assminfo-bioproject-lineage-parent-accession\n                               - assminfo-bioproject-lineage-parent-accessions\n                               - assminfo-bioproject-lineage-title\n                               - assminfo-biosample-accession\n                               - assminfo-biosample-attribute-name\n                               - assminfo-biosample-attribute-value\n                               - assminfo-biosample-bioproject-accession\n                               - assminfo-biosample-bioproject-parent-accession\n                               - assminfo-biosample-bioproject-parent-accessions\n                               - assminfo-biosample-bioproject-title\n                               - assminfo-biosample-description-comment\n                               - assminfo-biosample-description-organism-common-name\n                               - assminfo-biosample-description-organism-infraspecific-breed\n                               - assminfo-biosample-description-organism-infraspecific-cultivar\n                               - assminfo-biosample-description-organism-infraspecific-ecotype\n                               - assminfo-biosample-description-organism-infraspecific-isolate\n                               - assminfo-biosample-description-organism-infraspecific-sex\n                               - assminfo-biosample-description-organism-infraspecific-strain\n                               - assminfo-biosample-description-organism-name\n                               - assminfo-biosample-description-organism-pangolin\n                               - assminfo-biosample-description-organism-tax-id\n                               - assminfo-biosample-description-title\n                               - assminfo-biosample-ids-db\n                               - assminfo-biosample-ids-label\n                               - assminfo-biosample-ids-value\n                               - assminfo-biosample-last-updated\n                               - assminfo-biosample-models\n                               - assminfo-biosample-owner-contact-lab\n                               - assminfo-biosample-owner-name\n                               - assminfo-biosample-package\n                               - assminfo-biosample-publication-date\n                               - assminfo-biosample-status-status\n                               - assminfo-biosample-status-when\n                               - assminfo-biosample-submission-date\n                               - assminfo-blast-url\n                               - assminfo-description\n                               - assminfo-level\n                               - assminfo-linked-assm-accession\n                               - assminfo-linked-assm-type\n                               - assminfo-name\n                               - assminfo-notes\n                               - assminfo-paired-assm-accession\n                               - assminfo-paired-assm-changed\n                               - assminfo-paired-assm-manual-diff\n                               - assminfo-paired-assm-name\n                               - assminfo-paired-assm-only-genbank\n                               - assminfo-paired-assm-only-refseq\n                               - assminfo-paired-assm-status\n                               - assminfo-refseq-category\n                               - assminfo-release-date\n                               - assminfo-sequencing-tech\n                               - assminfo-status\n                               - assminfo-submitter\n                               - assminfo-suppression-reason\n                               - assminfo-synonym\n                               - assminfo-type\n                               - assmstats-contig-l50\n                               - assmstats-contig-n50\n                               - assmstats-gaps-between-scaffolds-count\n                               - assmstats-gc-count\n                               - assmstats-gc-percent\n                               - assmstats-genome-coverage\n                               - assmstats-number-of-component-sequences\n                               - assmstats-number-of-contigs\n                               - assmstats-number-of-organelles\n                               - assmstats-number-of-scaffolds\n                               - assmstats-scaffold-l50\n                               - assmstats-scaffold-n50\n                               - assmstats-total-number-of-chromosomes\n                               - assmstats-total-sequence-len\n                               - assmstats-total-ungapped-len\n                               - checkm-completeness\n                               - checkm-completeness-percentile\n                               - checkm-contamination\n                               - checkm-marker-set\n                               - checkm-marker-set-rank\n                               - checkm-species-tax-id\n                               - checkm-version\n                               - current-accession\n                               - organelle-assembly-name\n                               - organelle-bioproject-accessions\n                               - organelle-description\n                               - organelle-infraspecific-name\n                               - organelle-submitter\n                               - organelle-total-seq-length\n                               - organism-common-name\n                               - organism-infraspecific-breed\n                               - organism-infraspecific-cultivar\n                               - organism-infraspecific-ecotype\n                               - organism-infraspecific-isolate\n                               - organism-infraspecific-sex\n                               - organism-infraspecific-strain\n                               - organism-name\n                               - organism-pangolin\n                               - organism-tax-id\n                               - source_database\n                               - type_material-display_text\n                               - type_material-label\n                               - wgs-contigs-url\n                               - wgs-project-accession\n                               - wgs-url\n  -h, --help               help for genome\n      --inputfile string   Input file\n      --package string     Data package (zip archive), inputfile parameter is relative to the root path inside the archive\n\nGlobal Flags\n      --elide-header   Do not output header\n      --force          Force dataformat to run without type check prompt\n</code></pre> <p>For our question here, let's assume that we want to look at all available turtle genomes submitted by the Vertebrate Genomes Project, check their assembly level (<code>assminfo-level</code>), and scaffold N50 (<code>assmstats-scaffold-n50</code>), in addition to scientific name (<code>organism-name</code>) and NCBI assembly accession ID (<code>accession</code>). </p> <pre><code>datasets summary genome taxon turtles --as-json-lines --search \"Vertebrates Genome\" | dataformat tsv genome \\\n--fields accession,organism-name,assminfo-level,assmstats-scaffold-n50\n\nAssembly Accession      Organism Name   Assembly Level  Assembly Stats Scaffold N50\nGCA_009430475.1 Actinemys marmorata     Scaffold        13640393\nGCA_007922185.1 Carettochelys insculpta Scaffold        45881824\nGCA_007922165.1 Chelydra serpentina     Scaffold        21135443\nGCF_000241765.5 Chrysemys picta bellii  Chromosome      16028813\nGCA_000241765.5 Chrysemys picta bellii  Chromosome      16028813\nGCA_004028625.2 Cuora amboinensis       Scaffold        247606\nGCA_003846335.1 Cuora mccordi   Scaffold        32628679\nGCA_007922305.1 Dermatemys mawii        Scaffold        34365009\nGCA_007922225.1 Emydura subglobosa      Scaffold        44759016\nGCA_007922155.1 Mesoclemmys tuberculata Scaffold        46415247\nGCF_000230535.1 Pelodiscus sinensis     Scaffold        3350749\nGCA_000230535.1 Pelodiscus sinensis     Scaffold        3350749\nGCA_007922175.1 Pelusios castaneus      Scaffold        14055032\nGCA_007922195.1 Podocnemis expansa      Scaffold        37101370\nGCF_002925995.2 Terrapene carolina triunguis    Scaffold        24249581\nGCA_002925995.2 Terrapene carolina triunguis    Scaffold        24249581\n</code></pre> <p>The assemblies are show in alphabetical order (scientific name) and we can see that for some species, like Chrysemys picta bellii, we have two assemblies with the same scaffold N50. If we check the accession numbers, we will see that we have a GCF and a GCA assembly (GCF_000241765.5 and GCA_000241765.5). GCA assemblies and their associate annotation files represent the original submission by users, while GCF assemblies are a copy of the original submission that was selected to be annotated and part of the RefSeq collection. You can read more about the differences between GCA and GCF assemblies in our documentation page.</p> <p>For the sake of brevity, let's download only the GCF assemblies. In this case, we can create a list of accessions and save it as a text file that can be used as input for datasets. Let's call this file <code>turtles-ref.acc</code>:</p> <pre><code>GCF_000241765.5\nGCF_000230535.1\nGCF_002925995.2\n</code></pre> Using dataformat to create a text file:  In this case, since we are using only RefSeq genomes, we can use `dataformat` to help us create the input file with the accessions we need. Like this:  <pre><code>datasets summary genome taxon turtles --as-json-lines --search \"Vertebrates Genome\" --assembly-source refseq | dataformat tsv genome --elide-header --fields accession\n</code></pre> Using nano to create a text file:  You can create a text file with a list of accessions anywhere that's convenient for you. The only thing to be aware is to use UTF-8 encoding for the file to avoid any issues.    <pre><code>1. Open nano: `nano`   \n2. Paste/type the list of accessions/identifiers you would like to use.     \nYou can either right click and select \"Paste\" or use `Control + V` (Windows) or `Cmd + V` (Mac)    \n3. Press `Control + X` to exit   \n4. `Save modified buffer`: type `Y`   \n5. Type the file name: `turtles.acc` and press `Enter`\n</code></pre> <p>Now let's download the selected assemblies using datasets. In this case, we will download genomes by accession and not taxon:</p> <p><pre><code>datasets download genome accession --inputfile turtles.acc --filename turtles_vgp-select.zip\nCollecting 3  records [================================================] 100% 3/3\nDownloading: turtles_vgp-select.zip    2.18GB done\n</code></pre> After downloading it, let's unzip the data package and take a look at its contents:</p> <pre><code>unzip turtles_vgp-select.zip -d turtles-VGP\n\ntree turtles-VGP/\n\nturtles-VGP/\n|-- README.md\n`-- ncbi_dataset\n    `-- data\n        |-- GCF_000230535.1\n        |   `-- GCF_000230535.1_PelSin_1.0_genomic.fna\n        |-- GCF_000241765.5\n        |   `-- GCF_000241765.5_Chrysemys_picta_BioNano-3.0.4_genomic.fna\n        |-- GCF_002925995.2\n        |   `-- GCF_002925995.2_T_m_triunguis-2.0_genomic.fna\n        |-- assembly_data_report.jsonl\n        `-- dataset_catalog.json\n\n5 directories, 6 files\n</code></pre>"},{"location":"NCBI-datasets-cli/#5-datasets-documentation-and-tutorials","title":"5. Datasets documentation and tutorials","text":"<p>We have a documentation page with lots of information about about datasets and NCBI genome and assembly in general. Examples of information are: - Command-line tools: how to download and install the datasets CLI; - How-to guides: short, one-line datasets CLI tasks; - Tutorials: multi-task, longer tutorials, mostly based on feedback or questions we get from users;</p> <p>Please explore our docs and feel free to reach out if you need help with any tasks. </p> <p></p>"},{"location":"NCBI-datasets-cli/#6-bonus-exercise-downloading-a-large-number-of-genomes","title":"6. Bonus exercise: downloading a large number of genomes","text":"<p>By now, you've learned how to download a single or multiple genome assemblies and their associated annotation files. You also learned how to filter the download/metadata retrieval using the datasets CLI flags.</p> <p>In the examples we explored today, we were dealing with a relatively small number of genomes and download size. But it's not uncommon for our users to have download requests of thousands of genomes or hundreds of gigabytes of data. In those cases, we recommend users to use the \"dehydration/rehydration\" option in datasets. Some definitions:</p> <p>Dehydrated data package: data package without any data files (FASTA, GFF3, etc), only the dataset catalog and assembly report. A dehydrated data package includes a <code>fetch.txt</code> file, with a list of files to be downloaded during rehydration. Rehydration: to rehydrate a dehydrated data package means to download the data files that are listed in the <code>fetch.txt</code> file. Users can choose to download/rehydrate all files listed in the <code>fetch.txt</code> file or use the flag <code>--match</code> to part of the file names for rehydration.</p> <p>We will use the same turtle download example with the <code>--dehydrated</code> flag and look at the differences in the results.</p> <pre><code>datasets download genome accession --inputfile turtles.acc --filename turtles_vgp-select-dehy.zip --dehydrated\nCollecting 3  records [================================================] 100% 3/3\nDownloading: turtles_vgp-select-dehy.zip    6.79kB done\n</code></pre> <p>The first difference is the download size: 14KB dehydrated vs 9.14 GB regular download.</p> <p><pre><code>unzip turtles_vgp-select-dehy.zip -d turtles-vgp-dehydrated\ntree turtles-vgp-dehydrated/\n\nturtles-vgp-dehydrated/\n|-- README.md\n`-- ncbi_dataset\n    |-- data\n    |   |-- assembly_data_report.jsonl\n    |   `-- dataset_catalog.json\n    `-- fetch.txt\n\n2 directories, 4 files\n</code></pre> The second obvious difference is the absence of any data files or folders.  Now let's rehydrated this data package and see what happens:</p> <pre><code>datasets rehydrate --directory turtles-vgp-dehydrated\nFound 3 of 3 files for rehydration\nCompleted 3 of 3 [================================================] 100%\n</code></pre> <p>Let's look again at the folder <code>turtles-vgp-dehydrated</code> to see what changed:</p> <p><pre><code>tree turtles-vgp-dehydrated/\n\nturtles-vgp-dehydrated/\n|-- README.md\n`-- ncbi_dataset\n    |-- data\n    |   |-- GCF_000230535.1\n    |   |   `-- GCF_000230535.1_PelSin_1.0_genomic.fna\n    |   |-- GCF_000241765.5\n    |   |   `-- GCF_000241765.5_Chrysemys_picta_BioNano-3.0.4_genomic.fna\n    |   |-- GCF_002925995.2\n    |   |   `-- GCF_002925995.2_T_m_triunguis-2.0_genomic.fna\n    |   |-- assembly_data_report.jsonl\n    |   `-- dataset_catalog.json\n    `-- fetch.txt\n\n5 directories, 7 files\n</code></pre> With exception to the file <code>fetch.txt</code>, now the folder structure looks the same as we had with the original (non-dehydrated) download.</p>"},{"location":"NCBI-datasets-cli/#the-most-important-question-to-answer-is-why-would-i-use-this","title":"The most important question to answer is: why would I use this?","text":"<p>And the answer is: a dehydrated download is faster and more reliable than a regular download, simply because the number of files and amount of data being transferred is smaller. Also, the download process is serial, which means that one file is downloaded after the other, while the rehydration process runs in parallel, where multiple files can be downloaded at the same time. By default, datasets downloads/rehydrates 10 files in parallel, and that number can go up to 30. Another advantage is that the rehydration process can be resumed if it is interrupted for any reason; the same is not true for downloads: they either finish successfully or fail and can't be resumed, only restarted from the beginning. </p>"},{"location":"links/","title":"Links","text":""},{"location":"links/#bga23","title":"BGA23:","text":"<ul> <li>Gitpod (for the CLI tutorial): https://gitpod.io/#https://github.com/BGAcademy23/ncbidatasets</li> <li>Discord channel (for questions): #searching-and-downloading-genome-data-using-ncbi-datasets</li> </ul>"},{"location":"links/#ncbi-datasets-main-resources","title":"NCBI Datasets main resources","text":"<ul> <li>NCBI Datasets homepage: https://www.ncbi.nlm.nih.gov/datasets/</li> <li>Github: https://github.com/ncbi/datasets</li> </ul>"},{"location":"links/#download-and-installation-instructions-cli","title":"Download and installation instructions (CLI)","text":"<ul> <li>Instructions: https://www.ncbi.nlm.nih.gov/datasets/docs/v2/download-and-install/</li> </ul>"},{"location":"links/#tutorials-how-to-guides-and-past-workshops","title":"Tutorials, how-to guides and past workshops","text":"<ul> <li>How-to guides (short, one-line CLI tasks):  https://www.ncbi.nlm.nih.gov/datasets/docs/v2/how-tos/</li> <li>Tutorials (multi-task, longer tutorials, mostly based on feedback or questions we get from users): https://www.ncbi.nlm.nih.gov/datasets/docs/v2/tutorials/</li> <li>Past training sessions and workshops (Jupyter notebooks used in previous datasets training events): https://github.com/ncbi/datasets/tree/master/training</li> </ul>"},{"location":"links/#how-to-get-help","title":"How to get help","text":"<ul> <li>Email the helpdesk: info@ncbi.nlm.nih.gov</li> <li>Github: https://github.com/ncbi/datasets</li> <li>Yellow feedback button on our pages </li> </ul>"},{"location":"images/readme/","title":"Readme","text":"<p>Folder with images used in the NCBI Datasets CLI guide</p>"}]}